#SET ( WORKDIR ${CMAKE_SOURCE_DIR}/src )
INCLUDE_DIRECTORIES ( ${WORKDIR}/base )
IF ( NOT Server )
	INCLUDE_DIRECTORIES ( ${WORKDIR}/client )
	INCLUDE_DIRECTORIES ( ${WORKDIR}/screen )
	INCLUDE_DIRECTORIES ( ${WORKDIR}/widget )
	IF ( NOT Win )
		FIND_PACKAGE ( SDL REQUIRED )
		FIND_PACKAGE ( SDL_image REQUIRED )
		FIND_PACKAGE ( SDL_ttf REQUIRED )
	ENDIF ( NOT Win )
	INCLUDE_DIRECTORIES ( ${SDL_INCLUDE_DIR} ${SDLIMAGE_INCLUDE_DIR} ${SDLTTF_INCLUDE_DIR} )
	IF ( NOT NO_Audio )
		INCLUDE_DIRECTORIES ( ${WORKDIR}/audio )
		IF ( NOT Win )
			FIND_PACKAGE ( SDL_mixer REQUIRED )
		ENDIF ( NOT Win )
		INCLUDE_DIRECTORIES ( ${SDLMIXER_INCLUDE_DIR} )
		LINK_LIBRARIES ( ${SDL_LIBRARY} ${SDLIMAGE_LIBRARY} ${SDLMIXER_LIBRARY} ${SDLTTF_LIBRARY} SDLmain )
	ELSE (NOT NO_Audio)
		ADD_DEFINITIONS ( -DNO_SOUND )
		LINK_LIBRARIES ( ${SDL_LIBRARY} ${SDLIMAGE_LIBRARY} ${SDLTTF_LIBRARY} SDLmain )
	ENDIF ( NOT NO_Audio )
ELSE ( NOT Server )
	LINK_LIBRARIES ( ${CMAKE_DL_LIBS} )
	INCLUDE_DIRECTORIES ( ${WORKDIR}/server )
ENDIF ( NOT Server )
SET ( SRC_base_modules
${WORKDIR}/base/index.c ${WORKDIR}/base/space.c ${WORKDIR}/base/list.c
)
SET ( SRC_modWall
${SRC_base_modules}
modWall.c
)
SET ( SRC_modPipe
${SRC_base_modules}
modPipe.c
)
SET ( SRC_modTeleport
${SRC_base_modules}
modTeleport.c
)
SET ( SRC_modAI
${SRC_base_modules}
modAI.c
)

ADD_LIBRARY ( modWall SHARED ${SRC_modWall} )
ADD_LIBRARY ( modPipe SHARED ${SRC_modPipe} )
ADD_LIBRARY ( modTeleport SHARED ${SRC_modTeleport} )
ADD_LIBRARY ( modAI SHARED ${SRC_modAI} )
INSTALL ( TARGETS modWall LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}/${APPNAME} RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} )
INSTALL ( TARGETS modPipe LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}/${APPNAME} RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} )
INSTALL ( TARGETS modTeleport LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}/${APPNAME} RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} )
INSTALL ( TARGETS modAI LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}/${APPNAME} RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} )
